/*!
 * jQuery Plugin: Are-You-Sure (Dirty Form Detection)
 * https://github.com/codedance/jquery.AreYouSure/
 *
 * Copyright (c) 2012-2014, Chris Dance and PaperCut Software http://www.papercut.com/
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Author:  chris.dance@papercut.com
 * Version: 1.9.0
 * Date:    13th August 2014
 */
!function(l){l.fn.areYouSure=function(e){function t(){var e=l(this),i=e.find(r.fieldSelector);l(i).each(function(){var e=l(this);e.data("ays-orig")||(s(e),e.bind(r.fieldEvents,o))}),e.trigger("checkform.areYouSure")}function n(){d(l(this))}var r=l.extend({message:"You have unsaved changes!",dirtyClass:"dirty",change:null,silent:!1,addRemoveFieldsMarksDirty:!1,fieldEvents:"change keyup propertychange input",fieldSelector:":input:not(input[type=submit]):not(input[type=button])"},e),a=function(e){if(e.hasClass("ays-ignore")||e.hasClass("aysIgnore")||e.attr("data-ays-ignore")||void 0===e.attr("name"))return null;if(e.is(":disabled"))return"ays-disabled";var t,i=e.attr("type");switch(i=e.is("select")?"select":i){case"checkbox":case"radio":t=e.is(":checked");break;case"select":t="",e.find("option").each(function(e){var i=l(this);i.is(":selected")&&(t+=i.val())});break;default:t=e.val()}return t},s=function(e){e.data("ays-orig",a(e))},o=function(e){function i(e){var i=e.data("ays-orig");return void 0!==i&&a(e)!=i}var t=l(this).is("form")?l(this):l(this).parents("form");if(i(l(e.target)))u(t,!0);else{if($fields=t.find(r.fieldSelector),r.addRemoveFieldsMarksDirty)if(t.data("ays-orig-field-count")!=$fields.length)return void u(t,!0);var n=!1;$fields.each(function(){if($field=l(this),i($field))return!(n=!0)}),u(t,n)}},d=function(e){var i=e.find(r.fieldSelector);l(i).each(function(){s(l(this))}),l(i).unbind(r.fieldEvents,o),l(i).bind(r.fieldEvents,o),e.data("ays-orig-field-count",l(i).length),u(e,!1)},u=function(e,i){var t=i!=e.hasClass(r.dirtyClass);e.toggleClass(r.dirtyClass,i),t&&(r.change&&r.change.call(e,e),i&&e.trigger("dirty.areYouSure",[e]),i||e.trigger("clean.areYouSure",[e]),e.trigger("change.areYouSure",[e]))};return r.silent||window.aysUnloadSet||(window.aysUnloadSet=!0,l(window).bind("beforeunload",function(){if($dirtyForms=l("form").filter("."+r.dirtyClass),0!=$dirtyForms.length){if(navigator.userAgent.toLowerCase().match(/msie|chrome/)){if(window.aysHasPrompted)return;window.aysHasPrompted=!0,window.setTimeout(function(){window.aysHasPrompted=!1},900)}return r.message}})),this.each(function(e){var i;l(this).is("form")&&((i=l(this)).submit(function(){i.removeClass(r.dirtyClass)}),i.bind("reset",function(){u(i,!1)}),i.bind("rescan.areYouSure",t),i.bind("reinitialize.areYouSure",n),i.bind("checkform.areYouSure",o),d(i))})}}(jQuery);